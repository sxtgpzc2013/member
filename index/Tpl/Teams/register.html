<include file="public:header" />
<div class="row wrapper border-bottom white-bg page-heading">
	<div class="col-lg-10">
		<ol class="breadcrumb">
			<a href="__URL__"><i class="fa fa-home"></i></a>
            <li>
                <a href="__URL__">首页</a>
            </li>
            <li>
                <a>消费商管理</a>
            </li>
            <li>
                <strong>消费商注册</strong>
            </li>
        </ol>
	</div>
</div>
<div class="wrapper wrapper-content animated">
	<div class="row">
        <div class="col-lg-12">
            <div class="ibox float-e-margins">



                <form class="form-horizontal m-t" id="signupForm" action="__APP__/Teams/register" method="post">
					<input type="hidden" name="form_key" value="yes">
			        <div class="ibox-content" style="border:0">
						<div class="ibox-title" >
							<h5>基本信息</h5>
						</div>
			                <div class="form-group">
			                    <label class="col-sm-2 control-label">消费商编号</label>

			                    <div class="col-sm-7">
			                        <input type="text" class="form-control usernumber" name="usernumber">
			                    </div>

								<div class="col-sm-3">
			                        <a class="btn btn-white get_usernumber">验证编号</a>
			                    </div>
			                </div>

							<div class="form-group">
			                    <label class="col-sm-2 control-label">消费商姓名</label>

			                    <div class="col-sm-7">
			                        <input type="text" class="form-control" name="realname">
			                    </div>
			                </div>

							<div class="form-group">
			                    <label class="col-sm-2 control-label">消费商级别</label>

			                    <div class="col-sm-7">
			                        <select class="form-control" name="userrank">
										<option value="1">普通消费商 1980</option>
										<option value="2">银卡消费商 1万</option>
										<option value="3">金卡消费商 3万</option>
										<option value="4">钻卡消费商 5万</option>
			                        </select>
			                    </div>
			                </div>

							<div class="form-group">
			                    <label class="col-sm-2 control-label">消费商身份证号</label>

			                    <div class="col-sm-7">
			                        <input type="text" class="form-control" name="IDcard">
			                    </div>
			                </div>


							<div class="form-group">
			                    <label class="col-sm-2 control-label">消费商身份证所在区域</label>

			                    <div class="col-sm-7">
			                        <input type="text" class="form-control" name="ID_address">
			                    </div>
			                </div>

							<div class="form-group">
			                    <label class="col-sm-2 control-label">上传身份证附件</label>

			                    <div class="col-sm-7">
			                        <input type="text" class="form-control" text="身份证正面" name="ID_address_face">
			                    </div>
			                </div>

							<div class="form-group">
			                    <label class="col-sm-2 control-label">消费商手机号</label>

			                    <div class="col-sm-7">
			                        <input type="text" class="form-control" name="mobile">
			                    </div>
			                </div>

							<div class="form-group">
			                    <label class="col-sm-2 control-label">开户银行</label>

			                    <div class="col-sm-7">
									<select class="form-control" name="bankname">
										<option value="1">中国工商银行</option>
										<option value="2">中国农业银行</option>
										<option value="3">中国银行</option>
										<option value="4">中国建设银行</option>
										<option value="5">国家开发银行</option>
										<option value="6">中国进出口银行</option>
										<option value="7">中国农业发展银行</option>
										<option value="8">交通银行</option>
										<option value="9">中信银行</option>
										<option value="10">中国光大银行</option>
										<option value="11">华夏银行</option>
										<option value="12">中国民生银行</option>
										<option value="13">广东发展银行</option>
										<option value="14">深圳发展银行</option>
										<option value="15">招商银行</option>
										<option value="16">北京银行</option>
									</select>
			                    </div>
			                </div>

							<div class="form-group">
			                    <label class="col-sm-2 control-label">开户行地址</label>

			                    <div class="col-sm-7">
			                        <input type="text" class="form-control" name="bank_adress">
			                    </div>
			                </div>

							<div class="form-group">
			                    <label class="col-sm-2 control-label">银行卡号</label>

			                    <div class="col-sm-7">
			                        <input type="text" class="form-control" name="banknumber">
			                    </div>

								<div class="col-sm-3">
			                        <span>(开户人必须是消费商姓名)</span>
			                    </div>
			                </div>

							<div class="ibox-title">
								<h5>数字红酒资格</h5>
							</div>

							<div class="form-group">
			                    <label class="col-sm-2 control-label">数字红酒资格</label>

			                    <div class="col-sm-7">
									<label class="checkbox-inline">
			                            <input type="radio" value="1" id="inlineCheckbox1" name="red_wine_number"> 小戎子1箱
									</label>
									<label class="checkbox-inline">
			                            <input type="radio" value="2" id="inlineCheckbox2" name="red_wine_number"> 大戎子1箱
									</label>
			                    </div>
			                </div>

							<div class="ibox-title">
								<h3>关系信息</h3>
			                </div>

							<div class="form-group">
			                    <label class="col-sm-2 control-label">推荐人编号</label>

			                    <div class="col-sm-7">
			                        <input type="text" class="form-control tuijiannumber" name="tuijiannumber" value="{$member['usernumber']}">
			                    </div>

								<div class="col-sm-3">
									<span>(如何修改推荐人请重新获取报单中心)</span>
								</div>
			                </div>

							<div class="form-group">
			                    <label class="col-sm-2 control-label">报单中心</label>

			                    <div class="col-sm-7">
			                        <input type="text" class="form-control billcenternumber" name="billcenternumber" value="{$member['usernumber']}">
			                    </div>

								<div class="col-sm-3">
			                        <a class="btn btn-white get_billcenternumber">获取报单中心</a>
			                    </div>
			                </div>

							<div class="form-group">
			                    <label class="col-sm-2 control-label">接点人</label>

			                    <div class="col-sm-7">
			                        <input type="text" class="form-control parentnumber" name="parentnumber" value="{$member['usernumber']}">
			                    </div>

								<div class="col-sm-3">
									<span>(如何修改接点人,公司将会按先左后右排位)</span>
								</div>
			                </div>

							<div class="form-group">
			                    <label class="col-sm-2 control-label">接点区</label>

			                    <div class="col-sm-7">
									<select class="form-control zone" id="zone" name="zone">
										<?php if($_GET['zone']== 1 && $member['left_zone'] == 0){ ?>
											<option value="1">左区</option>
										<?php }elseif($_GET['zone']== 2 && $member['middle_zone'] == 0){ ?>
											<option value="2">中区</option>
										<?php }elseif($_GET['zone']== 3 && $member['right_zone'] == 0){ ?>
											<option value="3">右区</option>
										<?php } ?>
										<!-- <if condition="$_GET['zone'] eq 1">
												{$_GET['zone']}
											<option value="1">左区</option>
										<elseif condition="$_GET['zone'] == 2">
												123
											<option value="2">中区</option>
										<elseif condition="$_GET['zone'] eq 3">
											<option value="3">右区</option>
										</if> -->
									</select>
			                    </div>
			                </div>


							<div class="ibox-title">
								<h3>安全信息</h3>
			                </div>

							<div class="form-group">
			                    <label class="col-sm-2 control-label">一级密码</label>

			                    <div class="col-sm-7">
			                        <input type="text" class="form-control" name="psd1">
			                    </div>
			                </div>

							<div class="form-group">
			                    <label class="col-sm-2 control-label">确认一级密码</label>

			                    <div class="col-sm-7">
			                        <input type="text" class="form-control" name="confirm_psd1">
			                    </div>
			                </div>

							<div class="form-group">
			                    <label class="col-sm-2 control-label">二级密码</label>

			                    <div class="col-sm-7">
			                        <input type="text" class="form-control" name="psd2">
			                    </div>
			                </div>

							<div class="form-group">
			                    <label class="col-sm-2 control-label">确认二级密码</label>

			                    <div class="col-sm-7">
			                        <input type="text" class="form-control" name="confirm_psd2">
			                    </div>
			                </div>


							<div class="form-group">
			                    <label class="col-sm-2 control-label"></label>

			                    <div class="col-sm-7">
									<label class="checkbox-inline">
			                            <input type="checkbox" value="option1" id="inlineCheckbox1" name="is_free"> 我已阅读并同意本协议 <a>查看协议</a>
									</label>
			                    </div>
			                </div>

							<div class="form-group">
								<div class="col-sm-4 col-sm-offset-2">
									<button class="btn btn-primary" type="submit">保存内容</button>
									<button class="btn btn-white" type="submit">取消</button>
								</div>
							</div>
			        </div>

				</form>
            </div>
        </div>
    </div>



</div>
<include file="public:footer" />
<!-- jQuery Validation plugin javascript-->
<script src="__PUBLIC__/js/plugins/validate/jquery.validate.min.js"></script>
<script src="__PUBLIC__/js/plugins/validate/messages_zh.min.js"></script>
<script>
   //以下为修改jQuery Validation插件兼容Bootstrap的方法，没有直接写在插件中是为了便于插件升级
   $.validator.setDefaults({
	   highlight: function (element) {
		   $(element).closest('.form-group').removeClass('has-success').addClass('has-error');
	   },
	   success: function (element) {
		   element.closest('.form-group').removeClass('has-error').addClass('has-success');
	   },
	   errorElement: "span",
	   errorClass: "help-block m-b-none",
	   validClass: "help-block m-b-none"


   });

	//以下为官方示例
	$().ready(function () {
		// validate signup form on keyup and submit
		$("#signupForm").validate({
			rules: {
				usernumber: {
					required: true
				},
				realname: {
					required: true
				},
				IDcard: {
					required: true
				},
				mobile: {
					required: true
				},
				bankname: {
					required: true
				},
				bank_adress: {
					required: true
				},
				banknumber: {
					required: true
				},
				ID_address_face: {
					required: true
				},
				red_wine_number: {
					required: true
				},
				tuijiannumber: {
					required: true
				},
				billcenternumber: {
					required: true
				},
				parentnumber: {
					required: true
				},
				psd1: {
					required: true
				},
				confirm_psd1: {
					required: true
				},
				psd2: {
					required: true
				},
				confirm_psd2: {
					required: true
				},
				is_free: {
					required: true
				},
				zone: {
					required: true
				},
				agree: "required"
			}
		});

		$('.get_usernumber').click(function(){
			var usernumber = $('.usernumber').val();
			if(usernumber == null){
				alert("请输入用户编号");return false;
			}
			$.ajax({
	            url: "__APP__/Teams/get_usernumber",
	            type: "get",
	            data: {
	                usernumber: usernumber
	            },
	            success: function (resdata) {
					resdata = JSON.parse(resdata);
	                if (resdata.success == true) {
						if(resdata.data == 0){
							alert("用户编号验证成功,可以注册");
						}else{
							alert("用户编号已存在,请重新输入用户编号");
						}
	                } else {
	                    alert("编号验证出现错误 请重试");
	                }
	            }
	        });
		});

		$('.get_billcenternumber').click(function(){
			var tuijiannumber = $('.tuijiannumber').val();
			if(tuijiannumber == ""){
				alert("请输入推荐人编号");return false;
			}
			$.ajax({
	            url: "__APP__/Teams/get_billcenternumber",
	            type: "get",
	            data: {
	                usernumber: tuijiannumber
	            },
	            success: function (resdata) {
					resdata = JSON.parse(resdata);
	                if (resdata.success == true) {
						if(resdata.data == 0){
							alert("用户报单中心获取失败,请重新输入用户编号");
						}else{
							$('.billcenternumber').val(resdata.data);
						}
	                } else {
	                    alert("用户报单中心获取错误 请重试");
	                }
	            }
	        });
		});

		$('.parentnumber').blur(function(){

			var parentnumber = $('.parentnumber').val();
			if(parentnumber == ""){
				alert("请输入推荐人编号");return false;
			}
			$.ajax({
	            url: "__APP__/Teams/get_parentnumber_zone",
	            type: "get",
				dataType: "JSON",
	            data: {
	                usernumber: parentnumber
	            },
	            success: function (resdata) {
	                if (resdata.success == true) {
						if(resdata.data == ""){
							alert("用户区间获取失败,请重新输入推荐人用户编号");
						}else{
							var zone_list = resdata.data
							// var zone_list = JSON.stringify(resdata.data);
							var obj=document.getElementById('zone');
							obj.innerHTML = "";
							for(var key in zone_list){
							   //key是属性,object[key]是值
							   if(zone_list[key] == 0){
								   if(key == "left_zone"){
									   obj.options.add(new Option("左区","1"));
								   }else if(key == "middle_zone"){
									   obj.options.add(new Option("中区","2"));
								   }else if(key == "right_zone"){
									   obj.options.add(new Option("右区","3"));
								   }
							   }
							}


						}
	                } else {
	                    alert("用户报单中心获取错误 请重试");
	                }
	            }
	        });
		});



	});
</script>
